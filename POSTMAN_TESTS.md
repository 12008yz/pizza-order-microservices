# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Postman

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é: "–ì–ò–ì–ê–ü–û–ò–°–ö API"
2. –ë–∞–∑–æ–≤—ã–π URL: `http://localhost:3002` (–¥–ª—è user-service)

---

## üìã –¢–µ—Å—Ç—ã –¥–ª—è user-service

### 1. Health Check
- **Method:** `GET`
- **URL:** `http://localhost:3002/health`
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "service": "user-service"
}
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
- **Method:** `POST`
- **URL:** `http://localhost:3002/api/users/profile`
- **Headers:**
  - `Content-Type: application/json`
- **Body (raw JSON):**
```json
{
  "phone": "+79991234567"
}
```
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "phone": "+79991234567",
    "userId": null,
    "createdAt": "...",
    "updatedAt": "..."
  }
}
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
- **Method:** `GET`
- **URL:** `http://localhost:3002/api/users/profile?phone=%2B79991234567`
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `%2B` = `+` –≤ URL encoding
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "phone": "+79991234567",
    ...
  }
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- **Method:** `PUT`
- **URL:** `http://localhost:3002/api/users/profile`
- **Headers:**
  - `Content-Type: application/json`
- **Body (raw JSON):**
```json
{
  "phone": "+79991234567",
  "city": "–ú–æ—Å–∫–≤–∞",
  "address": "–¢–µ—Å—Ç–æ–≤–∞—è —É–ª–∏—Ü–∞, 1",
  "entrance": "2",
  "floor": 5,
  "intercomCode": "1234"
}
```
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "phone": "+79991234567",
    "city": "–ú–æ—Å–∫–≤–∞",
    "address": "–¢–µ—Å—Ç–æ–≤–∞—è —É–ª–∏—Ü–∞, 1",
    "entrance": "2",
    "floor": 5,
    "intercomCode": "1234",
    "updatedAt": "..."
  }
}
```

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è: –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
- **Method:** `POST`
- **URL:** `http://localhost:3002/api/users/profile`
- **Body:**
```json
{
  "phone": "123"
}
```
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": false,
  "error": "Invalid phone number format"
}
```

### 6. –í–∞–ª–∏–¥–∞—Ü–∏—è: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- **Method:** `POST`
- **URL:** `http://localhost:3002/api/users/profile`
- **Body:**
```json
{}
```
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": false,
  "error": "Phone number is required"
}
```

---

## üìã –¢–µ—Å—Ç—ã –¥–ª—è order-service

### 7. –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
- **Method:** `GET`
- **URL:** `http://localhost:3004/api/orders/by-phone?phone=%2B79991234567`
- **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": []
}
```
(–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –µ—Å–ª–∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç)

---

## üîç –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å
- **–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–≥—Ä–∞—Ü–∏—è –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–ß—Ç–æ –¥–µ–ª–∞–ª–∞ –º–∏–≥—Ä–∞—Ü–∏—è:**
  - –ò–∑–º–µ–Ω—è–ª–∞ `userId` –Ω–∞ `nullable` (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
  - –ò–∑–º–µ–Ω—è–ª–∞ `phone` –Ω–∞ `NOT NULL` –∏ `UNIQUE` (–æ—Å–Ω–æ–≤–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `20240101000003-update-user-profiles-phone-based.js`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `db:migrate:status`)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ SQL –≤ order-service
- **–û—à–∏–±–∫–∞:** `column "nan" does not exist`
- **–ü—Ä–∏—á–∏–Ω–∞:** 
  - –ü–∞—Ä–∞–º–µ—Ç—Ä `phone` –∏–∑ URL query (`?phone=%2B79991234567`) –Ω–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–ª—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  - Express –ø–µ—Ä–µ–¥–∞–≤–∞–ª –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å –∫–∞–∫ `NaN`
- **–†–µ—à–µ–Ω–∏–µ:** 
  - –î–æ–±–∞–≤–ª–µ–Ω–æ `decodeURIComponent(phone)` –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è URL
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  - –î–æ–±–∞–≤–ª–µ–Ω `trim()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–±–µ–ª–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl –≤ PowerShell
- **–ü—Ä–∏—á–∏–Ω–∞:** 
  - PowerShell –∏–º–µ–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º JSON (`{"phone":"..."}`)
  - –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
  - –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ pipe
- **–†–µ—à–µ–Ω–∏–µ:** Postman - –ª—É—á—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API (GUI, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)

---

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### ‚ùì –ù—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤?

**–û—Ç–≤–µ—Ç: –ù–ï–¢, —ç—Ç–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏!**

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ—Ñ–∏–ª—å (user-service):**
   - –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `user_profiles`
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –≤–≤–æ–¥–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞: `POST /api/users/profile`
   - –°–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **–ó–∞–∫–∞–∑—ã (order-service):**
   - –•—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `applications` (orders)
   - –°–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏: `POST /api/orders`
   - **–¢–µ–ª–µ—Ñ–æ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø—Ä—è–º–æ –≤ –∑–∞–∫–∞–∑–µ** (–ø–æ–ª–µ `phone` –≤ —Ç–∞–±–ª–∏—Ü–µ)

#### –°—Ü–µ–Ω–∞—Ä–∏–∏:

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ñ–∏–ª—å, –ø–æ—Ç–æ–º –∑–∞–∫–∞–∑—ã**
```
1. POST /api/users/profile ‚Üí —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ñ–∏–ª—å
2. POST /api/orders ‚Üí —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑ (—Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ –µ—Å—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª–µ)
3. GET /api/orders/by-phone ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–∫–∞–∑—ã –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–Ω–∞—á–∞–ª–∞ –∑–∞–∫–∞–∑, –ø–æ—Ç–æ–º –ø—Ä–æ—Ñ–∏–ª—å**
```
1. POST /api/orders ‚Üí —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑ (—Ç–µ–ª–µ—Ñ–æ–Ω –≤ –∑–∞–∫–∞–∑–µ)
2. GET /api/orders/by-phone ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–∫–∞–∑—ã (—Ä–∞–±–æ—Ç–∞–µ—Ç!)
3. POST /api/users/profile ‚Üí —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ñ–∏–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã, –±–µ–∑ –ø—Ä–æ—Ñ–∏–ª—è**
```
1. POST /api/orders ‚Üí —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑
2. GET /api/orders/by-phone ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–∫–∞–∑—ã (—Ä–∞–±–æ—Ç–∞–µ—Ç!)
3. –ü—Ä–æ—Ñ–∏–ª—å –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–æ–æ–±—â–µ
```

### ‚úÖ –í—ã–≤–æ–¥:

- **–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ** –æ—Ç –Ω–∞–ª–∏—á–∏—è –ø—Ä–æ—Ñ–∏–ª—è
- –ó–∞–∫–∞–∑—ã –∏ –ø—Ä–æ—Ñ–∏–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –∏ —Å–µ—Ä–≤–∏—Å–∞—Ö
- –¢–µ–ª–µ—Ñ–æ–Ω –≤ –∑–∞–∫–∞–∑–µ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω –≤ –ø—Ä–æ—Ñ–∏–ª–µ - —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ö–æ—Ç—è –æ–±—ã—á–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–≤–æ–¥–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Postman** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –ø—Ä–æ—â–µ –∏ –Ω–∞–≥–ª—è–¥–Ω–µ–µ
2. **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é** —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –≤ Postman:
   - `{{base_url}}` = `http://localhost:3002`
   - `{{phone}}` = `+79991234567`
4. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é** –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
