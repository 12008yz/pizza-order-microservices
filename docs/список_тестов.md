# Список тестов Jest и их проверки

## 1. Тесты авторизации (Auth Service)

### 1.1. Тест регистрации пользователя

- Проверяет успешную регистрацию нового администратора
- Проверяет хеширование пароля перед сохранением
- Проверяет ошибку при попытке регистрации с существующим email
- Проверяет создание accessToken и refreshToken при регистрации

### 1.2. Тест входа в систему (login)

- Проверяет успешный вход с валидными учетными данными
- Проверяет ошибку при несуществующем пользователе
- Проверяет ошибку при неверном пароле
- Проверяет создание токенов при входе

### 1.3. Тест обновления токена (refreshToken)

- Проверяет успешное обновление токена с валидным refreshToken
- Проверяет ошибку при невалидном refreshToken
- Проверяет ошибку при истекшем refreshToken
- Проверяет ошибку при отсутствии refreshToken в базе данных
- Проверяет ошибку при отсутствии пользователя

### 1.4. Тест выхода из системы (logout)

- Проверяет успешный выход с удалением refreshToken

### 1.5. Тест верификации токена (verifyToken)

- Проверяет успешную верификацию валидного токена
- Проверяет ошибку при отсутствии токена
- Проверяет ошибку при невалидном токене

### 1.6. Интеграционные тесты API авторизации

- Проверяет полный цикл авторизации: регистрация → вход → верификация → обновление токена → выход
- Проверяет все эндпоинты API авторизации

## 2. Тесты пользователей (User Service)

### 2.1. Тест получения профиля пользователя

- Проверяет получение профиля по userId
- Проверяет возврат null при отсутствии профиля
- Проверяет обработку ошибок базы данных

### 2.2. Тест работы с профилем по телефону

- Проверяет получение профиля по телефону
- Проверяет создание нового профиля при отсутствии
- Проверяет обновление существующего профиля

### 2.3. Интеграционные тесты API пользователей

- Проверяет получение профиля через API с авторизацией
- Проверяет ошибку 401 при отсутствии токена
- Проверяет ошибку 404 при отсутствии профиля

## 3. Тесты провайдеров и покрытия (Provider/Coverage Service)

### 3.1. Тест проверки адреса на покрытие

- Проверяет поиск провайдеров по городу
- Проверяет поиск провайдеров по городу и улице
- Проверяет поиск провайдеров по городу, улице и номеру дома
- Проверяет обработку номеров домов в диапазоне
- Проверяет обработку граничных значений диапазона
- Проверяет обработку null значений (весь город, все дома)
- Проверяет возврат уникальных ID провайдеров
- Проверяет обработку городов со специальными символами
- Проверяет возврат пустого массива при отсутствии покрытия

### 3.2. Тест получения провайдеров по адресу

- Проверяет получение активных провайдеров для адреса
- Проверяет фильтрацию неактивных провайдеров
- Проверяет возврат пустого массива при отсутствии провайдеров

### 3.3. Тест работы с городами и улицами

- Проверяет получение списка городов
- Проверяет получение списка улиц для города
- Проверяет фильтрацию null значений улиц
- Проверяет нормализацию названий городов

### 3.4. Тест создания и обновления покрытия

- Проверяет создание покрытия с нормализацией данных
- Проверяет создание покрытия с минимальными полями
- Проверяет обновление покрытия с нормализацией
- Проверяет ошибку при обновлении несуществующего покрытия
- Проверяет удаление покрытия

### 3.5. Тест тарифов (Tariff Service)

- Проверяет получение всех активных тарифов
- Проверяет фильтрацию тарифов по провайдеру
- Проверяет фильтрацию тарифов по типу услуги (интернет)
- Проверяет сортировку тарифов по цене
- Проверяет сортировку тарифов по скорости
- Проверяет получение тарифа по ID
- Проверяет ошибку при отсутствии тарифа

### 3.6. Интеграционные тесты API провайдеров

- Проверяет получение всех провайдеров
- Проверяет получение провайдера по ID
- Проверяет получение тарифов провайдера
- Проверяет создание нового провайдера
- Проверяет обновление провайдера
- Проверяет получение всех тарифов
- Проверяет фильтрацию тарифов по типу услуги
- Проверяет сортировку тарифов
- Проверяет создание, обновление и удаление тарифов

## 4. Тесты заказов (Order Service)

### 4.1. Тест создания заказа

- Проверяет создание заказа с валидными данными
- Проверяет ошибку при отсутствии номера телефона
- Проверяет ошибку при несуществующем тарифе
- Проверяет интеграцию с User Service и Provider Service

### 4.2. Тест расчета стоимости заказа

- Проверяет корректный расчет стоимости заказа
- Проверяет расчет стоимости роутера (покупка/аренда)
- Проверяет расчет стоимости ТВ-приставки (покупка/аренда)

### 4.3. Тест обновления статуса заказа

- Проверяет обновление статуса заказа
- Проверяет создание истории изменений статуса
- Проверяет отправку уведомлений при изменении статуса

### 4.4. Тест истории статусов заказа

- Проверяет получение истории изменений статуса заказа
- Проверяет сортировку истории по дате

## 5. Тесты оборудования (Equipment Service)

### 5.1. Тест типов оборудования

- Проверяет получение всех типов оборудования
- Проверяет получение типа оборудования по ID

### 5.2. Тест получения оборудования

- Проверяет получение всего оборудования
- Проверяет получение оборудования по провайдеру
- Проверяет получение оборудования по ID
- Проверяет фильтрацию оборудования по различным параметрам

### 5.3. Тест создания оборудования

- Проверяет создание оборудования с проверкой существования провайдера
- Проверяет ошибку при несуществующем провайдере
- Проверяет интеграцию с Provider Service

### 5.4. Тест обновления и удаления оборудования

- Проверяет обновление оборудования
- Проверяет удаление оборудования

### 5.5. Интеграционные тесты Equipment-Provider

- Проверяет получение информации о провайдере при получении оборудования
- Проверяет валидацию существования провайдера при создании оборудования
- Проверяет валидацию существования провайдера при обновлении оборудования
- Проверяет обработку недоступности Provider Service

### 5.6. Интеграционные тесты API оборудования

- Проверяет все эндпоинты API оборудования
- Проверяет фильтрацию и сортировку через API

## 6. Тесты локаций (Location Service)

### 6.1. Тест работы с регионами

- Проверяет получение всех регионов
- Проверяет обработку ошибок базы данных

### 6.2. Тест работы с городами

- Проверяет получение городов по региону
- Проверяет возврат пустого массива при отсутствии городов

### 6.3. Тест работы с улицами

- Проверяет получение улиц по городу
- Проверяет валидацию существования города

### 6.4. Тест работы со зданиями и квартирами

- Проверяет получение зданий по улице
- Проверяет получение квартир по зданию

### 6.5. Интеграционные тесты API локаций

- Проверяет получение регионов через API
- Проверяет получение городов по региону через API
- Проверяет получение типов улиц через API
- Проверяет поиск адресов через API
- Проверяет валидацию обязательных параметров

## 7. Тесты доступности (Availability Service)

### 7.1. Тест проверки доступности

- Проверяет быстрый путь при наличии buildingId
- Проверяет использование кэша при наличии
- Проверяет запрос к Provider Service при отсутствии кэша
- Проверяет обработку ошибок Provider Service

### 7.2. Тест получения провайдеров по ID адреса

- Проверяет получение провайдеров по buildingId
- Проверяет получение провайдеров по apartmentId
- Проверяет возврат пустого массива при отсутствии провайдеров

### 7.3. Тест очистки кэша

- Проверяет удаление истекших записей кэша
- Проверяет обработку ошибок при очистке

### 7.4. Тесты контроллера доступности

- Проверяет проверку доступности с валидным адресом
- Проверяет ошибку при отсутствии города
- Проверяет получение доступности по ID адреса
- Проверяет валидацию параметров

## 8. Тесты уведомлений (Notification Service)

### 8.1. Тест отправки уведомлений

- Проверяет отправку уведомления о создании заказа
- Проверяет отправку уведомления об изменении статуса заказа
- Проверяет интеграцию с Order Service

### 8.2. Тест получения уведомлений пользователя

- Проверяет получение уведомлений пользователя
- Проверяет сортировку уведомлений по дате
- Проверяет ограничение количества уведомлений

### 8.3. Тест отметки уведомлений как прочитанных

- Проверяет отметку уведомления как прочитанного
- Проверяет ошибку при отсутствии уведомления

## Резюме

Всего тестов покрывают:

- ✅ Авторизацию и аутентификацию
- ✅ Управление пользователями и профилями
- ✅ Работу с провайдерами и покрытием
- ✅ Управление тарифами
- ✅ Создание и обработку заказов (подача заявки на подключение)
- ✅ Управление оборудованием
- ✅ Работу с локациями
- ✅ Проверку доступности услуг
- ✅ Систему уведомлений
